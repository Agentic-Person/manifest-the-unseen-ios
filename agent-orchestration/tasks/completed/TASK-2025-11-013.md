---
task_id: TASK-2025-11-013
title: "Database - Seed Initial Data"
workstream: backend-infrastructure
phase: "Pre-Development - Week 2"
week: 2
status: active
priority: P1
assigned_agent: backend-specialist
estimated_hours: 4
actual_hours:
created: 2025-11-22
updated: 2025-11-22
completed:
---

## Objective
Populate the Supabase database with initial seed data (meditation sessions, test users, sample workbook/journal data) for development and testing.

## Context
**Why this task is important**:
- Enables testing of all features without manual data entry
- Provides realistic data for UI development
- Allows testing of tier gating and feature limits
- Creates consistent test environment for all developers

**Related documentation**:
- TDD Section 5: Database Schema (all table structures)
- PRD Section 6.1: Meditation & Breathing System (meditation content)
- Week 1 TASK-002: seed.sql file created

**Prerequisite knowledge**:
- Supabase seed data patterns
- SQL INSERT statements
- JSON data structures
- Test data best practices

## Acceptance Criteria
- [ ] **Meditations Seeded**: All 12 meditation sessions loaded (male + female narrators)
- [ ] **Test Users Created**: 3 users with different subscription tiers
- [ ] **Sample Workbook Data**: Each test user has sample workbook progress
- [ ] **Sample Journals**: Each test user has 3-5 journal entries
- [ ] **Tier Gating Works**: Free tier users have limited access, paid users have full access
- [ ] **Verification Script**: Data verification script created and passing
- [ ] **Documentation**: Seed data documented

## Implementation Steps

1. **Run Meditation Seed Data** (1h)
   - Execute `supabase/seed.sql` (created in Week 1):
     ```bash
     psql -f supabase/seed.sql
     ```
   - Verify 12 meditation sessions created:
     - 6 sessions × 2 narrators (male + female) = 12 total
     - Sessions: Introduction, Body Scan, Visualization, Breath Work, Deep Meditation, Energy Flow
   - Check meditation metadata (duration, tier, category)
   - Verify audio URLs (placeholder or actual)

2. **Create Test User Accounts** (1h)
   - Create 3 users via Supabase Auth dashboard or SQL:
     - **User 1 (Free Tier)**:
       - Email: novice@test.com
       - subscription_tier: 'novice_path'
       - trial_ends_at: NULL (trial ended)
     - **User 2 (Mid Tier)**:
       - Email: awakening@test.com
       - subscription_tier: 'awakening_path'
       - trial_ends_at: NULL
     - **User 3 (Premium)**:
       - Email: enlightenment@test.com
       - subscription_tier: 'enlightenment_path'
       - trial_ends_at: NULL
   - Document user UUIDs
   - Verify user profiles auto-created (auth trigger from TASK-010)

3. **Seed Workbook Progress Data** (1h)
   - For each test user, insert sample workbook data:
     ```sql
     INSERT INTO workbook_progress (user_id, phase, data)
     VALUES (
       'user-1-uuid',
       1,
       '{"wheel_of_life": {"career": 7, "health": 5, ...}, "completed": true}'::jsonb
     );
     ```
   - User 1 (Free): Phases 1-3 (partial progress)
   - User 2 (Mid): Phases 1-6 (some completed)
   - User 3 (Premium): Phases 1-10 (all accessible)
   - Test tier gating: Free user cannot access Phase 6+

4. **Seed Journal Entries** (0.5h)
   - For each user, insert 3-5 journal entries:
     ```sql
     INSERT INTO journal_entries (user_id, title, content, tags)
     VALUES (
       'user-1-uuid',
       'My first journal entry',
       'Today I started my manifestation journey...',
       ARRAY['gratitude', 'goals']
     );
     ```
   - Mix of dates (last 7 days)
   - Various tags
   - Test full-text search works

5. **Seed Meditation Sessions** (0.5h)
   - Insert meditation session history for test users:
     ```sql
     INSERT INTO meditation_sessions (user_id, meditation_id, completed, duration_seconds)
     VALUES (
       'user-1-uuid',
       'meditation-uuid',
       true,
       600
     );
     ```
   - User 1: 2-3 completed sessions
   - User 2: 5-7 sessions
   - User 3: 10+ sessions
   - Test session history tracking

6. **Create Data Verification Script** (0.5h)
   - Create `scripts/verify-seed-data.sql`:
     ```sql
     -- Check meditation count
     SELECT COUNT(*) FROM meditations; -- Should be 12

     -- Check user count
     SELECT COUNT(*) FROM users; -- Should be 3

     -- Check workbook data
     SELECT user_id, COUNT(*) FROM workbook_progress GROUP BY user_id;

     -- Check journal entries
     SELECT user_id, COUNT(*) FROM journal_entries GROUP BY user_id;

     -- Check meditation sessions
     SELECT user_id, COUNT(*) FROM meditation_sessions GROUP BY user_id;
     ```
   - Run verification script
   - All counts should match expected

7. **Test Tier Gating** (0.5h)
   - Login as Free user (novice@test.com):
     - Can access meditations 1-3 only
     - Can create max 50 journals (test limit)
     - Can access workbook phases 1-5 only
   - Login as Mid user (awakening@test.com):
     - Can access meditations 1-6
     - Can create max 200 journals
     - Can access phases 1-8
   - Login as Premium user (enlightenment@test.com):
     - Can access all meditations
     - Unlimited journals
     - All phases accessible
   - Document tier gating behavior

## Dependencies
**Blocks**:
- None (enables testing, but doesn't block development)

**Blocked By**:
- TASK-2025-11-010: Database must exist
- TASK-2025-11-011: pgvector should be set up first

**Related Tasks**:
- TASK-2025-11-010: Database migrations
- TASK-2025-11-012: RLS verification (uses test users from this task)

## Resources
**Documentation**:
- [Supabase Seed Data](https://supabase.com/docs/guides/cli/local-development#seed-your-database)
- [PostgreSQL INSERT](https://www.postgresql.org/docs/current/sql-insert.html)

**Internal resources**:
- TDD Section 5: Database Schema (all tables)
- PRD Section 6.1: Meditation content
- `supabase/seed.sql` (meditation data, created in Week 1)
- `packages/shared/src/constants/index.ts` (tier limits)

**Code examples**:
- seed.sql file from Week 1 TASK-002
- Tier limits from shared package

## Agent Instructions
**Recommended agent**: Backend Specialist (with Supabase MCP)

**Specific guidance for this task**:
- Use Supabase MCP to insert seed data
- Start with meditation data (already in seed.sql)
- Create realistic test data (don't use "test" or "foo/bar")
- Document test user credentials securely
- Verify tier gating works correctly

**Technical constraints**:
- Must create exactly 12 meditation sessions (6 × 2 narrators)
- Must create exactly 3 test users (one per tier)
- All seed data must respect RLS policies
- Tier limits must be enforced correctly

## Review Checklist
Before marking complete, ensure:

- [ ] **Meditations Loaded**: All 12 meditation sessions in database
- [ ] **Users Created**: 3 test users with different tiers
- [ ] **Workbook Data**: Sample workbook progress for each user
- [ ] **Journal Entries**: 3-5 journal entries per user
- [ ] **Meditation Sessions**: Session history for each user
- [ ] **Tier Gating**: Verified limits work correctly
- [ ] **Verification Script**: Created and passing
- [ ] **Documentation**: Test user credentials documented securely

## Progress Notes
**2025-11-22 - Orchestrator**:
- Task created for Week 2 Day 4
- Assigned to Backend Specialist
- Requires TASK-010 and TASK-011 completion

## Final Notes
(Add any learnings, gotchas, or context for future developers)
