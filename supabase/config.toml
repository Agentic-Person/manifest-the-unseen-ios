# =============================================================================
# Supabase Local Development Configuration
# =============================================================================
# This file configures local Supabase instance for development.
# Settings here do NOT affect production - configure those in Supabase Dashboard.
# =============================================================================

# -----------------------------------------------------------------------------
# Project Settings
# -----------------------------------------------------------------------------
project_id = "manifest-the-unseen"

[api]
enabled = true
# Port to use for the API URL.
port = 54321
# Schemas to expose in your API. Tables, views and stored procedures in these
# schemas will get API endpoints.
schemas = ["public", "storage"]
# Extra schemas to add to the search_path of every request.
extra_search_path = ["public", "extensions"]
# The maximum number of rows returned from a view, table, or stored procedure.
max_rows = 1000

[db]
# Port to use for the local database.
port = 54322
# The database major version to use.
major_version = 15

[db.pooler]
enabled = false
# Port to use for the local connection pooler.
port = 54329
# Specifies when a server connection can be reused by other clients.
# Configure one of the supported pooler modes: `transaction`, `session`.
pool_mode = "transaction"
# How many server connections to allow per user/database pair.
default_pool_size = 20
# Maximum number of client connections allowed.
max_client_conn = 100

[realtime]
enabled = true
# Bind realtime via either IPv4 or IPv6. (default: IPv6)
# ip_version = "IPv6"

[studio]
enabled = true
# Port to use for Supabase Studio.
port = 54323
# External URL of the API server that frontend connects to.
api_url = "http://localhost"

# -----------------------------------------------------------------------------
# Authentication Settings
# -----------------------------------------------------------------------------
[auth]
enabled = true
# The base URL of your website. Used as an allow-list for redirects and for
# constructing URLs used in emails.
site_url = "http://localhost:3000"

# A list of *exact* URLs that auth providers are permitted to redirect to post
# authentication.
additional_redirect_urls = [
  "manifesttheunseen://auth/callback",
  "http://localhost:19006/auth/callback",  # Expo dev server
]

# How long tokens are valid for (in seconds). Defaults to 3600 (1 hour),
# maximum 604,800 (1 week).
jwt_expiry = 3600

# Allow/disallow new user signups to your project.
enable_signup = true

[auth.email]
# Allow/disallow new user signups via email to your project.
enable_signup = true
# If enabled, a user will be required to confirm any email change on both the
# old and new addresses.
double_confirm_changes = true
# If enabled, users need to confirm their email address before signing in.
enable_confirmations = true

# -----------------------------------------------------------------------------
# Email Configuration (Local Development)
# -----------------------------------------------------------------------------
[auth.email.template.invite]
subject = "Welcome to Manifest the Unseen"
content_path = "./supabase/templates/invite.html"

[auth.email.template.confirmation]
subject = "Confirm Your Email - Manifest the Unseen"
content_path = "./supabase/templates/confirmation.html"

[auth.email.template.recovery]
subject = "Reset Your Password - Manifest the Unseen"
content_path = "./supabase/templates/recovery.html"

[auth.email.template.magic_link]
subject = "Your Magic Link - Manifest the Unseen"
content_path = "./supabase/templates/magic_link.html"

[auth.email.template.email_change]
subject = "Confirm Email Change - Manifest the Unseen"
content_path = "./supabase/templates/email_change.html"

# -----------------------------------------------------------------------------
# External OAuth Providers
# -----------------------------------------------------------------------------
# Configure these in production via Supabase Dashboard
# For local development, these are placeholders

[auth.external.apple]
enabled = true
client_id = ""
secret = ""
# Overrides the default auth redirectUrl.
redirect_uri = ""

[auth.external.google]
enabled = false
client_id = ""
secret = ""

# -----------------------------------------------------------------------------
# Storage Configuration
# -----------------------------------------------------------------------------
[storage]
enabled = true
# The maximum file size allowed (e.g. "5MB", "500KB").
file_size_limit = "50MB"

# -----------------------------------------------------------------------------
# Edge Functions Configuration
# -----------------------------------------------------------------------------
[functions.ai-chat]
verify_jwt = true

# -----------------------------------------------------------------------------
# Analytics Configuration
# -----------------------------------------------------------------------------
[analytics]
enabled = false

# -----------------------------------------------------------------------------
# Database Seed Configuration
# -----------------------------------------------------------------------------
# Use this to populate your local database with test data
# Uncomment to enable seeding on `supabase start`
# [db.seed]
# enabled = true
# sql_paths = ['./supabase/seed.sql']

# =============================================================================
# PRODUCTION CONFIGURATION
# =============================================================================
# For production settings, use Supabase Dashboard:
# - Authentication: https://app.supabase.com/project/_/auth/providers
# - Storage: https://app.supabase.com/project/_/storage/buckets
# - Edge Functions: Deploy via CLI (`supabase functions deploy`)
# - Database: Migrations are applied via `supabase db push`
# =============================================================================
